# 🔒 Penetration Testing Features

Aplikasi Black-Box Testing sekarang dilengkapi dengan fitur penetration testing untuk mendeteksi kerentanan keamanan pada aplikasi web.

## 🎯 Fitur yang Tersedia

### 1. XSS (Cross-Site Scripting) Testing
- **Basic Script Injection**: `<script>alert('XSS')</script>`
- **Image Tag XSS**: `<img src=x onerror=alert('XSS')>`
- **SVG XSS**: `<svg onload=alert('XSS')>`
- **Input Tag XSS**: `<input onfocus=alert('XSS') autofocus>`
- **Link XSS**: `<a href=javascript:alert('XSS')>Click</a>`

### 2. SQL Injection Testing
- **Basic Union Select**: `' UNION SELECT 1,2,3--`
- **Boolean-based**: `' OR 1=1--`, `' AND 1=2--`
- **Time-based**: `' OR SLEEP(3)--`
- **Authentication Bypass**: `' OR '1'='1`, `admin'--`
- **Error-based**: Deteksi error messages dari database

## 🚀 Cara Menggunakan

### 1. Melalui UI Streamlit
1. Buka aplikasi dengan `streamlit run app/main.py`
2. Di sidebar, pilih mode testing (Crawler/YAML/Single Page)
3. Aktifkan opsi **"XSS Testing"** dan/atau **"SQL Injection Testing"**
4. Jalankan test seperti biasa
5. Lihat hasil di bagian **"🔒 Penetration Testing Results"**

### 2. Melalui Code
```python
from app.services.xss_pentest import XSSPentester
from app.services.sql_pentest import SQLPentester

# XSS Testing
xss_tester = XSSPentester()
xss_result = await xss_tester.run_xss_test(page, url)

# SQL Injection Testing
sql_tester = SQLPentester()
sql_result = await sql_tester.run_sql_test(page, url)
```

## 📊 Hasil Testing

### XSS Test Results
```json
{
  "url": "https://example.com",
  "form_tests": [
    {
      "input_name": "username",
      "payload": "<script>alert('XSS')</script>",
      "is_vulnerable": true,
      "response_snippet": "Error: <script>alert('XSS')</script>",
      "risk_level": "high"
    }
  ],
  "summary": {
    "total_tests": 1,
    "vulnerabilities_found": 1,
    "high_vulnerabilities": 1
  }
}
```

### SQL Injection Test Results
```json
{
  "url": "https://example.com",
  "form_tests": [
    {
      "input_name": "search",
      "payload": "' UNION SELECT 1,2,3--",
      "is_vulnerable": true,
      "response_snippet": "MySQL error: You have an error in your SQL syntax",
      "risk_level": "high"
    }
  ],
  "summary": {
    "total_tests": 1,
    "vulnerabilities_found": 1,
    "critical_vulnerabilities": 0
  }
}
```

## 🛡️ Keamanan dan Etika

### ⚠️ PENTING: Gunakan dengan Bijak
- **Hanya test aplikasi yang Anda miliki atau memiliki izin**
- **Jangan gunakan untuk aktivitas ilegal**
- **Test di lingkungan development/staging, bukan production**
- **Backup data sebelum testing**

### 🔒 Safe Mode
- Testing dilakukan dengan payload yang relatif aman
- Tidak merusak data atau sistem
- Fokus pada deteksi vulnerability, bukan eksploitasi

## 📈 Laporan

### HTML Report
- Tabel hasil dengan kolom XSS dan SQL vulnerabilities
- Badge merah untuk vulnerability ditemukan
- Badge hijau untuk tidak ada vulnerability

### CSV Report
- Kolom tambahan: `XSS Vulnerabilities`, `SQL Vulnerabilities`
- Data numerik untuk analisis

### JSON Report
- Data lengkap termasuk payload dan response snippet
- Machine-readable untuk integrasi dengan tools lain

## 🔧 Konfigurasi

### Environment Variables
```bash
# Timeout untuk pentest (default: 2000ms)
PENTEST_TIMEOUT=2000

# Headless mode untuk pentest
PENTEST_HEADLESS=true
```

### Custom Payloads
Anda dapat menambahkan payload custom dengan memodifikasi:
- `app/services/xss_pentest.py` - untuk XSS payloads
- `app/services/sql_pentest.py` - untuk SQL injection payloads

## 🚨 Troubleshooting

### Error: "No vulnerabilities found"
- Pastikan halaman memiliki form input
- Cek apakah form dapat di-submit
- Pastikan response mengandung payload yang di-inject

### Error: "Timeout during testing"
- Increase timeout value
- Pastikan koneksi internet stabil
- Coba dengan headless=false untuk debugging

### Error: "Form not found"
- Pastikan halaman memiliki form dengan input text/password
- Coba dengan URL yang berbeda
- Pastikan halaman sudah fully loaded

## 📚 Contoh Penggunaan

Lihat file `examples/test_pentest.py` untuk contoh lengkap penggunaan programmatic.

```bash
# Jalankan contoh
python examples/test_pentest.py
```

## 🔄 Update dan Maintenance

### Menambah Payload Baru
1. Edit file `app/services/xss_pentest.py` atau `app/services/sql_pentest.py`
2. Tambahkan payload baru di method `_load_payloads()`
3. Test dengan aplikasi target

### Menambah Deteksi Pattern
1. Edit method `detect_xss_in_response()` atau `detect_sql_in_response()`
2. Tambahkan pattern regex baru
3. Test dengan berbagai response

## 📞 Support

Jika mengalami masalah:
1. Cek log error di console
2. Pastikan dependencies terinstall dengan benar
3. Test dengan URL yang sederhana terlebih dahulu
4. Gunakan headless=false untuk debugging visual

---

**⚠️ Disclaimer**: Fitur ini hanya untuk tujuan testing keamanan yang legal dan etis. Pengguna bertanggung jawab penuh atas penggunaan fitur ini.
